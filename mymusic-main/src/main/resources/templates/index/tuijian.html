<!DOCTYPE html>
<html lang="en" class="app" xmlns:th="http://www.thymeleaf.org" taglib>

<head>
    <meta charset="utf-8" />
    <title>Musik | Web Application</title>
    <meta name="description" content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="stylesheet" th:href="@{js/jPlayer/jplayer.flat.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/bootstrap.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/animate.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/font-awesome.min.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/simple-line-icons.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/font.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{css/app.css}" type="text/css" />
    <!--[if lt IE 9]>
    <script th:src="@{js/ie/html5shiv.js}"></script>
    <script th:src="@{js/ie/respond.min.js}"></script>
    <script th:src="@{js/ie/excanvas.js}"></script>
    <![endif]-->
</head>

<body class="" onload="pageChangetuijian(1)">
<section class="vbox">
    <header class="bg-white-only header header-md navbar navbar-fixed-top-xs">
        <div class="navbar-header aside bg-primary nav-xs">
            <a class="btn btn-link visible-xs" data-toggle="class:nav-off-screen,open" data-target="#nav,html">
                <i class="icon-list"></i>
            </a>
            <a th:href="@{member}" class="navbar-brand text-lt">
                <i class="icon-earphones"></i>
                <img th:src="@{images/logo.png}" alt="." class="hide">
                <span class="hidden-nav-xs m-l-sm">Musik</span>
            </a>
            <a class="btn btn-link visible-xs" data-toggle="dropdown" data-target=".user">
                <i class="icon-settings"></i>
            </a>
        </div>
        <ul class="nav navbar-nav hidden-xs">
            <li>
                <a href="#nav,.navbar-header" data-toggle="class:nav-xs,nav-xs" class="text-muted">
                    <i class="fa fa-indent text"></i>
                    <i class="fa fa-dedent text-active"></i>
                </a>
            </li>
        </ul>

        <div class="navbar-right ">
            <ul class="nav navbar-nav m-n hidden-xs nav-user user">
                <li class="hidden-xs">

                    <section class="dropdown-menu aside-xl animated fadeInUp">
                        <section class="panel bg-white">
                            <div class="panel-heading b-light bg-light">
                                <strong>You have <span class="count">2</span> notifications</strong>
                            </div>
                            <div class="list-group list-group-alt">
                                <a href="#" class="media list-group-item">
											<span class="pull-left thumb-sm">
                      <img src="images/a0.png" alt="..." class="img-circle">
                    </span>
                                    <span class="media-body block m-b-none">
                      Use awesome animate.css<br>
                      <small class="text-muted">10 minutes ago</small>
                    </span>
                                </a>
                                <a href="#" class="media list-group-item">
											<span class="media-body block m-b-none">
                      1.0 initial released<br>
                      <small class="text-muted">1 hour ago</small>
                    </span>
                                </a>
                            </div>
                            <div class="panel-footer text-sm">
                                <a href="#" class="pull-right"><i class="fa fa-cog"></i></a>
                                <a href="#notes" data-toggle="class:show animated fadeInRight">See all the notifications</a>
                            </div>
                        </section>
                    </section>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle bg clear" data-toggle="dropdown">
								<span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm">
                <img src="images/a0.png" alt="...">
              </span><span id="userspan" th:text="${session.User.username}"></span><b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu animated fadeInRight">
                        <li>
                            <a th:href="@{toGeRenXinXi}">个人信息</a>
                        </li>
                        <li>
                            <a th:href="@{toAddUserMusic}">上传歌曲</a>
                        </li>
                        <hr>
                        <li>
                            <a th:href="@{logout}" >注销</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </header>
    <section>
        <section class="hbox stretch">
            <!-- .aside -->
            <aside class="bg-black dk nav-xs aside hidden-print" id="nav">
                <section class="vbox">
                    <section class="w-f-md scrollable">
                        <div class="slim-scroll" data-height="auto" data-disable-fade-out="true" data-distance="0" data-size="10px" data-railOpacity="0.2">

                            <!-- nav -->
                            <nav class="nav-primary hidden-xs">
                                <ul class="nav bg clearfix">
                                    <li class="hidden-nav-xs padder m-t m-b-sm text-xs text-muted">
                                        推荐
                                    </li>
                                    <li>
                                        <a th:href="@{member}">
                                            <i class="icon-disc icon text-success"></i>
                                            <span class="font-bold">发现音乐</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a th:href="@{toMusic}">
                                            <i class="icon-music-tone-alt icon text-info"></i>
                                            <span class="font-bold">音乐</span>
                                        </a>
                                    </li>

                                    <li>
                                        <a th:href="@{toSinger}" data-target="#content" data-el="#bjax-el" data-replace="true">
                                            <i class="icon-social-youtube icon  text-primary"></i>
                                            <span class="font-bold">歌手</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a th:href="@{toTuiJian}">
                                            <i class="icon-drawer icon text-primary-lter"></i>
                                            <span class="font-bold">推荐</span>
                                        </a>
                                    </li>

                                    <li class="m-b hidden-nav-xs"></li>
                                </ul>

                            </nav>
                            <!-- / nav -->
                        </div>
                    </section>


                </section>
            </aside>
            <!-- /.aside -->
            <section id="content">
                <section class="vbox">
                    <section class="scrollable" style="background-color:#f2f4f4">
                        <div style="width: 100%; height: 2000px;background-color: #efefef;padding-top: 70px;">
                            <div style="width: 80%; height: 100%;margin-left: 10%;background-color: #FFF">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                                            <form>
                                                <h2><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>推荐</h2>
                                                <hr />
                                                <div class="form-group">
                                                    <label for="recommend_music">推荐音乐：</label>
                                                    <input type="text" class="form-control" id="recommend_music" name="songname" placeholder="音乐名称">
                                                </div>
                                                <div class="form-group">
                                                    <label for="rec-person">音乐人：</label>
                                                    <input type="text" class="form-control" id="rec-person" name="singer" placeholder="音乐人">
                                                </div>
                                                <div class="form-group">
                                                    <label for="regard" style="font-family: '宋体';font-size: 15px;">推荐理由：</label>
                                                    <textarea class="form-control" name="account" id="regard" rows="10" placeholder="请发表您的想法..."></textarea>
                                                </div>

                                                <button type="submit" class="btn btn-success" id="subBtn" style="width: 100px;font-size: 15px;">发表</button>
                                            </form>
                                        </div>
                                        <div class="col-md-3 col-md-12 col-sm-12 col-xs-12">
                                            <h3>指南</h3> 请使用精简的语言写出您推荐这首歌的想法
                                        </div>
                                    </div>
                                    <div style="height: 100%;margin-top: 100px;">
                                        <div class="media" style="margin-bottom: 12px;background-color: #efefec" id="comment-div">

                                        </div>
                                        <div style="width:100%; border:1px solid #8ca1af;"></div>
                                        <tfoot >
                                        <tr>
                                            <td colspan="6" align="center">
                                                <ul class="pagination" style="margin-left: 33%;">

                                                </ul>
                                            </td>
                                        </tr>

                                        </tfoot>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </section>
                </section>
            </section>
        </section>
    </section>
    </section>

    <script th:src="@{js/jquery.min.js}"></script>
    <!-- Bootstrap -->
    <script th:src="@{js/bootstrap.js}"></script>
    <!-- App -->
    <script th:src="@{js/app.js}"></script>
    <script th:src="@{js/slimscroll/jquery.slimscroll.min.js}"></script>
    <script th:src="@{js/masonry/tiles.min.js}"></script>
    <script th:src="@{js/masonry/demo.js}"></script>
    <script th:src="@{js/app.plugin.js}"></script>
    <script type="text/javascript" th:src="@{js/jPlayer/jquery.jplayer.min.js}"></script>
    <script type="text/javascript" th:src="@{js/jPlayer/add-on/jplayer.playlist.min.js}"></script>
    <script type="text/javascript" th:src="@{js/jPlayer/demo.js}"></script>

    <script th:src="@{song_js/images/jquery.min.js}"></script>
<script th:src="@{backstage/jquery/layer/layer.js}"></script>
<script>
    function pageChangetuijian(pageno) {
        //window.location.href="${APP_PATH}/user/userList.do?pageno="+pageno
        queryPageTuiJian(pageno);
    }

    var jsonObj = {
        "pageno": 1,
        "pagesize": 10
    }

    var loadingIndex = -1;

    function queryPageTuiJian(pageno) {
        jsonObj.pageno = pageno;
        $
            .ajax({
                type: "POST",
                data: jsonObj,
                url: "TuiJianList",
                beforeSend: function () {
                    loadingIndex = layer.load(2, {
                        time: 10 * 1000
                    });
                    return true;
                },
                success: function (result) {
                    layer.close(loadingIndex);
                    if (result.success) {
                        var page = result.page;
                        var data = page.datas;

                        var content = '';




                        $.each(data, function (i, n) {

                            content += '<div class="media-left" style="margin-bottom: 50px;padding-left: 100px;"><br>';

                            content += '  <h2>'
                                + n.username
                                + '：</h2>';
                            content += ' <h3 style="color: #00AA88">'
                                + n.songname + '--' + n.singer
                                + '<a onclick="window.location.href=\'toBofangqi?songname='+ n.songname+ '&singer='+n.singer+'\'" ><img src="images/g4.png" height="20" width="20" style="margin-left: 10px"/></a></h3>';
                            content += '<h4>'
                                + n.account
                                + '</h4>';
                            content += '  </div>';

                        });

                        $("#comment-div").html(content);

                        var contentBar = '';

                        if (page.pageno == 1) {
                            contentBar += '<li class="disabled"><a href="#">上一页</a></li>';
                        } else {
                            contentBar += '<li><a href="#" onclick="pageChangetuijian('
                                + (pageno - 1) + ')">上一页</a></li>';
                        }

                        for (var i = 1; i <= page.totalno; i++) {
                            contentBar += '<li ';
                            if (page.pageno == i) {
                                contentBar += 'class="active"';
                            }
                            contentBar += '><a href="#" onclick="pageChangetuijian('
                                + i + ')">' + i + '</a></li>';
                        }

                        if (page.pageno == page.totalno) {
                            contentBar += '<li class="disabled"><a href="#" >下一页</a></li>';
                        } else {
                            contentBar += '<li><a href="#" onclick="pageChangetuijian('
                                + (pageno + 1) + ')">下一页</a></li>';
                        }

                        $(".pagination").html(contentBar);

                    } else {
                        layer.msg(result.msg, {
                            time: 1000,
                            icon: 5,
                            shift: 6
                        });
                    }
                },
                error: function () {
                    layer.msg("加载失败", {
                        time: 1000,
                        icon: 5,
                        shift: 6
                    });
                }

            });
    }

    $("#subBtn").click(function () {
        var userspan = $("#userspan");
        var fregard = $("#regard");
        var fsongname= $("#recommend_music");
        var fsinger = $("#rec-person");
        $.ajax({
            type: "POST",
            data: {
                "username" : userspan.text(),
                "songname": fsongname.val(),
                "account": fregard.val(),
                "singer": fsinger.val()
            },
            url: "doAddComment",
            beforeSend: function () {
                layer.msg("请稍等！", {time: 6000, icon: 5, shift: 6});
                return true;
            },
            success: function (result) {
                if (result.success) {
                    pageChangetuijian(1);
                    fregard.val("");
                }
            },
            error: function () {
                layer.msg("<a style='color:red;'>数据不存在！</a>", {time: 3000, icon: 5, shift: 6});
            },

        });

    });
</script>
</body>

</html>